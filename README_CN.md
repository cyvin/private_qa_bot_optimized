## **README (Chinese Version)**

```markdown
# 私有知识问答机器人（优化版）

## 项目概述

**私有知识问答机器人（优化版）** 是基于 **检索增强生成（RAG）** 架构的聊天机器人，旨在管理私有知识库。该机器人支持文档上传、自动向量化、历史问答检索，并通过 Gradio 提供友好的交互界面。系统经过优化，适用于本地知识处理，支持基于文档的查询和更新。

## 功能特性

- **实时问答聊天**：支持动态、实时、上下文感知的对话。
- **文档管理**：用户可以上传文档（PDF、DOCX），系统会自动向量化并将其加入知识库。
- **历史问答检索**：查看系统保存的历史问答记录。
- **模块化设计**：系统各个部分模块化，便于扩展或替换（如语言模型或文档存储系统）。
- **数据库集成**：使用 SQLite 存储历史问答和文件元数据，确保数据的持久化。

## 项目结构

```
private_qa_bot_optimized/
├── app.py                        # 程序入口：初始化 Gradio 界面
├── config.py                     # 配置文件：路径、嵌入模型等
├── requirements.txt              # 所需依赖列表
├── chat_history.db               # 存储历史问答记录的 SQLite 数据库（自动生成）
├── ui/                           # 用户界面模块
│   ├── layout.py                 # 页面布局：定义标签和组件结构
│   ├── qa_page.py                # 问答页面：接收用户输入并返回回答
│   ├── history_page.py           # 历史记录页面：显示过去的问答历史
│   ├── library_page.py           # 文档管理页面：上传和删除文档
│   ├── help_page.py              # 使用说明页面：提供系统使用指导
├── retriever/                    # 文档检索与向量化
│   ├── ingest.py                 # 模拟文档向量化
│   └── loader.py                 # 加载文档进行处理
├── chains/                       # 数据处理链（目前为模拟设置）
│   └── qa_chain.py               # 模拟问答链
├── llm/                          # 为未来的语言模型集成预留的模块
│   └── __init__.py
├── utils/                        # 工具类模块（当前为空）
│   └── __init__.py
└── docs/                         # 用户上传的文档目录
```

## 依赖安装

- **Gradio**: 用于构建Web界面，负责前端展示。
- **LangChain**: 用于构建基于语言模型的应用框架，负责处理问答链。
- **ChromaDB**: 向量数据库，用于存储和查询文档的向量。
- **Pandas**: 用于操作数据和生成 Markdown 格式的表格。
- **Python-docx**: 用于处理 DOCX 文件。
- **PyPDF2**: 用于处理 PDF 文件。

所需的依赖列在 `requirements.txt` 中，可以通过以下命令安装：

```bash
pip install -r requirements.txt
```

## 如何使用

### 步骤 1：克隆仓库

```bash
git clone https://github.com/cyvin/private_qa_bot_optimized.git
cd private_qa

_bot_optimized
```

### 步骤 2：设置虚拟环境

创建并激活虚拟环境：

```bash
python -m venv venv
source venv/bin/activate  # Windows 系统使用: venv\Scripts\activate
```

安装依赖：

```bash
pip install -r requirements.txt
```

### 步骤 3：配置环境

在项目根目录创建 `.env` 文件（如果需要配置 API 密钥等信息）并添加必要的配置信息。例如：

```env
DEEPSEEK_API_KEY=your_api_key_here
```

### 步骤 4：运行应用

使用以下命令启动应用：

```bash
python app.py
```

这将在本地启动一个 Web 服务器，你可以在浏览器中访问：

```
http://localhost:7860
```

## 系统模块说明

### 1. **Gradio 界面**

系统基于 **Gradio** 构建，为用户提供友好的界面。主要功能通过标签页实现：

- **问答标签**：用户可以输入问题，系统从知识库中检索并返回答案。
- **文档标签**：用户上传新文档，系统会自动向量化并存储。
- **历史标签**：查看之前问过的问题和回答。
- **帮助标签**：提供系统使用说明。

### 2. **文档管理**

通过 **文档标签** 上传文件。上传的文档会使用预设的模型进行向量化，并存储到向量数据库中。系统支持对上传的文档进行删除和更新。

### 3. **问答链**

**问答链** 使用 **LangChain** 来查询知识库并返回答案。问答功能基于文档的上下文，可以通过调整参数优化回答质量。

### 4. **SQLite 数据库**

**SQLite 数据库** (`chat_history.db`) 存储所有的互动记录，包括：

- 用户提问
- 系统回答
- 时间戳

这些数据可以通过 **历史记录标签** 进行查看。

## 未来扩展方向

1. **集成真实语言模型**：将当前的模拟问答链替换为真实的语言模型，如 OpenAI GPT 或 DeepSeek API。
2. **多语言支持**：扩展系统，支持多语言文档和查询。
3. **更多文档格式支持**：支持更多的文档格式（如 Markdown、图片 OCR 处理等）。
4. **用户身份认证**：实现用户登录和多用户知识空间功能。
5. **模型定制**：提供用户自定义嵌入模型和向量化处理功能。

## 已知问题

- **性能问题**：目前文档的向量化和检索是模拟的。集成真实的模型和数据库将提升性能和准确性。
- **扩展性**：系统适用于小规模数据集，对于更大规模的数据集，需要优化数据存储和检索。

## 结论

**私有知识问答机器人（优化版）** 项目是一个完整的基于 RAG 架构的知识管理和问答系统。它支持文档上传、向量化、问答和历史记录展示，非常适合部署在个人和企业的知识管理系统中。未来的增强可以集中在集成真实模型、扩展文档处理功能和提高系统性能上。

如有任何问题或需要更多功能，可以随时提出问题或为该仓库贡献代码！

---

你可以直接使用这些内容作为你的 **`README.md`** 文件！如果需要进一步修改或格式化，告诉我即可。